function Vq = fungInterpolation_g(Xq,Yq,I)

x0 = floor(Xq) - 1;
y0 = floor(Yq) - 1;
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% I = f(x0:(x0+3), y0:(y0+3));
Dx = [1 1 1 1 1; 
      2 2 2 2 2;
      Xq-x0+1 Xq-x0+1 Xq-x0+1 Xq-x0+1 Xq-x0+1; 
      3 3 3 3 3; 
      4 4 4 4 4];
Dy = [1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4;
      1 2 Yq-y0+1 3 4];
I2 = ba_interp2(I,Dy,Dx,'cubic');
Vq = I2(3,3);
%%%%%%%%%% figure;
%%%%%%%%%% mesh(Dx,Dy,I2)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% [X,Y] = ndgrid(x0:x0+3,y0:y0+3);
% % V = f(x0:x0+3,y0:y0+3);
% 
% F = griddedInterpolant(X,Y,I,'cubic'); 
% Vq = F(Xq,Yq);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
% %%%%%%%%%%%%%%%%%%%Plot%%%%%%%%%%%%%%%%
% [Xq,Yq] = ndgrid(1:0.5:10,1:0.5:10);
% Vq = F(Xq,Yq);
% mesh(Xq,Yq,Vq);
% 
% function gInterpolation  =  fungInterpolation_g(x,y,g)
%  
% 
% x0 = floor(x)  ;
% y0 = floor(x)  ;
% x1 = x0+1;  
% y1 = y0+1;  
% 
% p = x - x1;
% q = y - y1;
%  
% gInterpolation = (-1/6*p*(p-1)*(p-2))*(-1/6*q*(q-1)*(q-2))*g(1,1) + ...
%     (-1/6*p*(p-1)*(p-2))*(1/2*(q+1)*(q-1)*(q-2))*g(1,2) + ...
%     (-1/6*p*(p-1)*(p-2))*(-1/2*(q+1)*q*(q-2))*g(1,3) + ...
%     (-1/6*p*(p-1)*(p-2))*(1/6*(q+1)*(q)*(q-1))*g(1,4) + ...
%     ...
%     (1/2*(p+1)*(p-1)*(p-2))*(-1/6*q*(q-1)*(q-2))*g(2,1) + ...
%     (1/2*(p+1)*(p-1)*(p-2))*(1/2*(q+1)*(q-1)*(q-2))*g(2,2) + ...
%     (1/2*(p+1)*(p-1)*(p-2))*(-1/2*(q+1)*q*(q-2))*g(2,3) + ...
%     (1/2*(p+1)*(p-1)*(p-2))*(1/6*(q+1)*(q)*(q-1))*g(2,4) + ...
%     ...
%     (-1/2*(p+1)*p*(p-2))*(-1/6*q*(q-1)*(q-2))*g(3,1) + ...
%     (-1/2*(p+1)*p*(p-2))*(1/2*(q+1)*(q-1)*(q-2))*g(3,2) + ...
%     (-1/2*(p+1)*p*(p-2))*(-1/2*(q+1)*q*(q-2))*g(3,3) + ...
%     (-1/2*(p+1)*p*(p-2))*(1/6*(q+1)*(q)*(q-1))*g(3,4) + ...
%     ...
%     (1/6*p*(p-1)*(p+1))*(-1/6*q*(q-1)*(q-2))*g(4,1) + ...
%     (1/6*p*(p-1)*(p+1))*(1/2*(q+1)*(q-1)*(q-2))*g(4,2) + ...
%     (1/6*p*(p-1)*(p+1))*(-1/2*(q+1)*q*(q-2))*g(4,3) + ...
%     (1/6*p*(p-1)*(p+1))*(1/6*(q+1)*(q)*(q-1))*g(4,4);


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% x0 = floor(xq) - 1;
% y0 = floor(yq) - 1;
% x1 = x0+1; x2 = x0+2; x3 = x0+3;
% y1 = y0+1; y2 = y0+2; y3 = y0+3;
%  
% I = I(:);
% L = [1 x0 y0 x0^2 y0^2 x0*y0 x0^3 x0^2*y0 x0*y0^2 y0^3 x0*y0^3 x0^2*y0^2 x0^3*y0 x0^2*y0^3 x0^3*y0^2 x0^3*y0^3;
%      1 x1 y0 x1^2 y0^2 x1*y0 x1^3 x1^2*y0 x1*y0^2 y0^3 x1*y0^3 x1^2*y0^2 x1^3*y0 x1^2*y0^3 x1^3*y0^2 x1^3*y0^3;
%      1 x2 y0 x2^2 y0^2 x2*y0 x2^3 x2^2*y0 x2*y0^2 y0^3 x2*y0^3 x2^2*y0^2 x2^3*y0 x2^2*y0^3 x2^3*y0^2 x2^3*y0^3;
%      1 x3 y0 x3^2 y0^2 x3*y0 x3^3 x3^2*y0 x3*y0^2 y0^3 x3*y0^3 x3^2*y0^2 x3^3*y0 x3^2*y0^3 x3^3*y0^2 x3^3*y0^3;
%      1 x0 y1 x0^2 y1^2 x0*y1 x0^3 x0^2*y1 x0*y1^2 y0^3 x0*y1^3 x0^2*y1^2 x0^3*y1 x0^2*y1^3 x0^3*y1^2 x0^3*y1^3;
%      1 x1 y1 x1^2 y1^2 x1*y1 x1^3 x1^2*y1 x1*y1^2 y1^3 x1*y1^3 x1^2*y1^2 x1^3*y1 x1^2*y1^3 x1^3*y1^2 x1^3*y1^3;
%      1 x2 y1 x2^2 y1^2 x2*y1 x2^3 x2^2*y1 x2*y1^2 y1^3 x2*y1^3 x2^2*y1^2 x2^3*y1 x2^2*y1^3 x2^3*y1^2 x2^3*y1^3;
%      1 x3 y1 x3^2 y1^2 x3*y1 x3^3 x3^2*y1 x3*y1^2 y1^3 x3*y1^3 x3^2*y1^2 x3^3*y1 x3^2*y1^3 x3^3*y1^2 x3^3*y1^3;
%      1 x0 y2 x0^2 y2^2 x0*y2 x0^3 x0^2*y2 x0*y2^2 y2^3 x0*y2^3 x0^2*y2^2 x0^3*y2 x0^2*y2^3 x0^3*y2^2 x0^3*y2^3;
%      1 x1 y2 x1^2 y2^2 x1*y2 x1^3 x1^2*y2 x1*y2^2 y2^3 x1*y2^3 x1^2*y2^2 x1^3*y2 x1^2*y2^3 x1^3*y2^2 x1^3*y2^3;
%      1 x2 y2 x2^2 y2^2 x2*y2 x2^3 x2^2*y2 x2*y2^2 y2^3 x2*y2^3 x2^2*y2^2 x2^3*y2 x2^2*y2^3 x2^3*y2^2 x2^3*y2^3;
%      1 x3 y2 x3^2 y2^2 x3*y2 x3^3 x3^2*y2 x3*y2^2 y2^3 x3*y2^3 x3^2*y2^2 x3^3*y2 x3^2*y2^3 x3^3*y2^2 x3^3*y2^3;
%      1 x0 y3 x0^2 y3^2 x0*y3 x0^3 x0^2*y3 x0*y3^2 y3^3 x0*y3^3 x0^2*y3^2 x0^3*y3 x0^2*y3^3 x0^3*y3^2 x0^3*y3^3;
%      1 x1 y3 x1^2 y3^2 x1*y3 x1^3 x1^2*y3 x1*y3^2 y3^3 x1*y3^3 x1^2*y3^2 x1^3*y3 x1^2*y3^3 x1^3*y3^2 x1^3*y3^3;
%      1 x2 y3 x2^2 y3^2 x2*y3 x2^3 x2^2*y3 x2*y3^2 y3^3 x2*y3^3 x2^2*y3^2 x2^3*y3 x2^2*y3^3 x2^3*y3^2 x2^3*y3^3;
%      1 x3 y3 x3^2 y3^2 x3*y3 x3^3 x3^2*y3 x3*y3^2 y3^3 x3*y3^3 x3^2*y3^2 x3^3*y3 x3^2*y3^3 x3^3*y3^2 x3^3*y3^3];
% Coeff = L\I;
% Vq = [1 xq yq xq^2 yq^2 xq*yq xq^3 xq^2*yq xq*yq^2 yq^3 xq*yq^3 xq^2*yq^2 xq^3*yq xq^2*yq^3 xq^3*yq^2 xq^3*yq^3 ]*Coeff;

 